# LinearAlgebra_cuda - GPU åŠ é€Ÿçº¿æ€§ä»£æ•°åº“æ€§èƒ½æµ‹è¯•å¹³å°

**ç‰ˆæœ¬**: 2.0  
**æ›´æ–°æ—¥æœŸ**: 2025-10-14  
**çŠ¶æ€**: âœ… å®Œæˆå¹¶å¯ç”¨

---

## ğŸ¯ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ GPU åŠ é€Ÿçº¿æ€§ä»£æ•°åº“æ€§èƒ½æµ‹è¯•å¹³å°ï¼Œç”¨äºå¯¹æ¯” **AMGX**ã€**HYPRE** å’Œ **PETSc** ä¸‰å¤§ä¸»æµåº“åœ¨ CPU å’Œ GPU æ¨¡å¼ä¸‹çš„æ€§èƒ½è¡¨ç°ã€‚

**ç‰¹ç‚¹**:
- âœ… **7ä¸ªæˆåŠŸæµ‹è¯•æ¨¡å—** (AMGX, HYPRE, PETSc çš„ CPU/GPU ç‰ˆæœ¬ + GPU Native)
- âœ… **GPU Native å®ç°** (AMGX â­, PETSc âš ï¸; HYPRE âŒ æœ‰å·²çŸ¥é—®é¢˜)
- âœ… **CPU/GPU åŒæ¨¡å¼å¯¹æ¯”**
- âœ… **ç²¾åº¦å®Œå…¨å¯¹é½** (~1e-7 ç›¸å¯¹æ®‹å·®)
- âœ… **YAML é…ç½®ç³»ç»Ÿ** (åŠ¨æ€é€‰æ‹©æ±‚è§£å™¨å’Œé¢„æ¡ä»¶å™¨)
- âœ… **è¯¦ç»†æ€§èƒ½åˆ†æ** (7ä¸ª Markdown æ–‡æ¡£)

---

## ğŸ† æ€§èƒ½äº®ç‚¹ (512Ã—512 ç½‘æ ¼)

| æ’å | åº“ + é…ç½® | æ€»æ—¶é—´ | æ±‚è§£æ—¶é—´ | è¿­ä»£æ•° |
|-----|----------|--------|---------|--------|
| ğŸ¥‡ | **AMGX Native + Jacobi** | **0.016s** âš¡ | 0.012s | 1 |
| ğŸ¥ˆ | AMGX Native + AMG | 0.122s | 0.089s | 64 |
| ğŸ¥‰ | AMGX GPU + AMG | 0.147s | 0.112s | 65 |
| 4 | PETSc GPU + GAMG | 0.452s | **0.034s** | 12 |
| 5 | HYPRE GPU + BoomerAMG | 0.531s | 0.134s | **5** |

**å…³é”®å‘ç°**:
- âš¡ **AMGX Native + Jacobi** å¯¹ Poisson é—®é¢˜æƒŠäººåœ°å¿« (1æ¬¡è¿­ä»£ï¼)
- ğŸ† **HYPRE BoomerAMG** è¿­ä»£æ¬¡æ•°æœ€å°‘ (5æ¬¡)
- ğŸ¯ **PETSc GPU** æ±‚è§£é˜¶æ®µæœ€å¿« (0.034s)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ„å»ºé¡¹ç›®

**æ–¹æ³• A: ä½¿ç”¨ Python è„šæœ¬ï¼ˆæ¨èï¼‰â­**
```bash
cd /home/zzy/Plasma/gpu/LinearAlgebra_cuda
python3 rebuild.py
```

**æ–¹æ³• B: ä½¿ç”¨ä¼ ç»Ÿè„šæœ¬**
```bash
cd /home/zzy/Plasma/gpu/LinearAlgebra_cuda
./build.sh
```

### 2. è¿è¡Œæµ‹è¯•
```bash
cd build

# æ ‡å‡†æµ‹è¯•ï¼ˆæ¨èï¼‰
./amgx_tests/amgx_poisson_solver              # AMGX GPU
./hypre_tests/hypre_poisson_solver            # HYPRE CPU
./hypre_gpu_tests/hypre_gpu_poisson_solver    # HYPRE GPU
./petsc_tests/petsc_poisson_solver            # PETSc CPU
./petsc_gpu_tests/petsc_gpu_poisson_solver    # PETSc GPU

# GPU Native æµ‹è¯•ï¼ˆçŸ©é˜µåœ¨GPUç«¯ç»„è£…ï¼‰
./amgx_gpu_native_tests/amgx_gpu_native_poisson_solver   # âœ… æ¨è
./petsc_gpu_native_tests/petsc_gpu_native_poisson_solver # âš ï¸ æ¯”æ ‡å‡†ç‰ˆæ…¢
```

### 3. æŸ¥çœ‹ç»“æœ
```bash
cd results
ls -lh  # æŸ¥çœ‹ç”Ÿæˆçš„ CSV å’Œ JSON æ–‡ä»¶
```

---

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### â­ æ ¸å¿ƒæ–‡æ¡£ï¼ˆå¿…è¯»ï¼‰

| æ–‡æ¡£ | å†…å®¹ç®€ä»‹ | ä¼˜å…ˆçº§ |
|------|---------|--------|
| **[2025-10-14_æ€§èƒ½æµ‹è¯•æ€»ç»“.md](2025-10-14_æ€§èƒ½æµ‹è¯•æ€»ç»“.md)** | æ‰€æœ‰æ¨¡å—å®Œæ•´å¯¹æ¯”ã€æ€§èƒ½æ’åã€ä½¿ç”¨å»ºè®® | â­â­â­â­â­ |
| **[2025-10-14_AMGXé¢„æ¡ä»¶å™¨å¯¹æ¯”.md](2025-10-14_AMGXé¢„æ¡ä»¶å™¨å¯¹æ¯”.md)** | AMG vs Jacobi å¯¹æ¯”ï¼Œä¸ºä½• Jacobi 1æ¬¡è¿­ä»£ | â­â­â­â­ |
| **[solver_config.yaml](solver_config.yaml)** | YAML é…ç½®æ–‡ä»¶ï¼ˆåŠ¨æ€é€‰æ‹©æ±‚è§£å™¨ï¼‰ | â­â­â­ |

### ğŸ“– æŠ€æœ¯æ–‡æ¡£

| æ–‡æ¡£ | å†…å®¹ç®€ä»‹ | ä¼˜å…ˆçº§ |
|------|---------|--------|
| **[2025-10-14_GPU_Nativeæ€§èƒ½åˆ†æ.md](2025-10-14_GPU_Nativeæ€§èƒ½åˆ†æ.md)** | GPU Native å®ç°å¯¹æ¯”å’Œåˆ†æ | â­â­â­â­ |
| **[2025-10-14_GPUå®ç°ç»†èŠ‚åˆ†æ.md](2025-10-14_GPUå®ç°ç»†èŠ‚åˆ†æ.md)** | çŸ©é˜µ/å‘é‡åœ¨ device è¿˜æ˜¯ host | â­â­â­ |
| **[2025-10-14_GPUçŸ©é˜µç»„è£…æŒ‡å—.md](2025-10-14_GPUçŸ©é˜µç»„è£…æŒ‡å—.md)** | å¦‚ä½•åœ¨ GPU ç«¯ç»„è£…çŸ©é˜µ | â­â­â­ |
| **[2025-10-14_HYPREé—®é¢˜æ€»ç»“.md](2025-10-14_HYPREé—®é¢˜æ€»ç»“.md)** | HYPRE GPU Native å¤±è´¥åˆ†æ | â­â­ |

### ğŸ“ å†å²å½’æ¡£

| ç›®å½• | å†…å®¹ |
|------|------|
| **[doc/test_results/2025-10-14/](doc/test_results/2025-10-14/)** | 2025-10-14 æµ‹è¯•æ•°æ®ï¼ˆCSV/JSONï¼‰ |
| **[doc/archived_docs/2025-10-14/](doc/archived_docs/2025-10-14/)** | 2025-10-14 æ–‡æ¡£å¿«ç…§ |

---

## ğŸ¯ é˜…è¯»æŒ‡å—

### é¦–æ¬¡ä½¿ç”¨è€…
1. **é˜…è¯»**: [2025-10-14_æ€§èƒ½æµ‹è¯•æ€»ç»“.md](2025-10-14_æ€§èƒ½æµ‹è¯•æ€»ç»“.md)
2. **è¿è¡Œ**: ä¸Šæ–¹"å¿«é€Ÿå¼€å§‹"ä¸­çš„æµ‹è¯•
3. **æŸ¥çœ‹**: `results/` ç›®å½•ä¸‹çš„ç»“æœæ–‡ä»¶

### æƒ³é…ç½®æ±‚è§£å™¨
1. **é˜…è¯»**: [2025-10-14_AMGXé¢„æ¡ä»¶å™¨å¯¹æ¯”.md](2025-10-14_AMGXé¢„æ¡ä»¶å™¨å¯¹æ¯”.md)
2. **ç¼–è¾‘**: [solver_config.yaml](solver_config.yaml)
3. **é‡è·‘**: æµ‹è¯•å¹¶å¯¹æ¯”æ€§èƒ½

### æƒ³äº†è§£ GPU Native
1. **é˜…è¯»**: [2025-10-14_GPU_Nativeæ€§èƒ½åˆ†æ.md](2025-10-14_GPU_Nativeæ€§èƒ½åˆ†æ.md)
2. **å‚è€ƒ**: [2025-10-14_GPUçŸ©é˜µç»„è£…æŒ‡å—.md](2025-10-14_GPUçŸ©é˜µç»„è£…æŒ‡å—.md)
3. **äº†è§£**: [2025-10-14_HYPREé—®é¢˜æ€»ç»“.md](2025-10-14_HYPREé—®é¢˜æ€»ç»“.md)

### æ·±å…¥æŠ€æœ¯ç»†èŠ‚
1. **é˜…è¯»**: [2025-10-14_GPUå®ç°ç»†èŠ‚åˆ†æ.md](2025-10-14_GPUå®ç°ç»†èŠ‚åˆ†æ.md)
2. **æµè§ˆ**: æºä»£ç  (`*_tests/` ç›®å½•)

---

## ğŸ“¦ æµ‹è¯•æ¨¡å—

```
LinearAlgebra_cuda/
â”œâ”€â”€ amgx_tests/              # AMGX GPU (æ ‡å‡†)
â”œâ”€â”€ amgx_gpu_native/         # AMGX GPU Native âœ…
â”œâ”€â”€ hypre_tests/             # HYPRE CPU
â”œâ”€â”€ hypre_gpu_tests/         # HYPRE GPU
â”œâ”€â”€ hypre_gpu_native/        # HYPRE GPU Native âŒ
â”œâ”€â”€ petsc_tests/             # PETSc CPU
â”œâ”€â”€ petsc_gpu_tests/         # PETSc GPU
â”œâ”€â”€ petsc_gpu_native/        # PETSc GPU Native âš ï¸
â”œâ”€â”€ common/                  # é€šç”¨å·¥å…·åº“
â”‚   â”œâ”€â”€ timer.h              # è®¡æ—¶å™¨
â”‚   â”œâ”€â”€ result_writer.h      # ç»“æœè¾“å‡º
â”‚   â”œâ”€â”€ matrix_generator.h   # çŸ©é˜µç”Ÿæˆ
â”‚   â”œâ”€â”€ config_reader.h      # YAML é…ç½®è¯»å–
â”‚   â””â”€â”€ gpu_matrix_generator.cuh  # GPU çŸ©é˜µç”Ÿæˆæ ¸å‡½æ•°
â”œâ”€â”€ build/                   # æ„å»ºç›®å½•
â””â”€â”€ results/                 # ç»“æœè¾“å‡ºç›®å½•
```

---

## ğŸ› ï¸ ç¯å¢ƒè¦æ±‚

- **CUDA**: 12.6+
- **GPU**: NVIDIA (æµ‹è¯•ç¯å¢ƒ: RTX 4060 Ti)
- **MPI**: OpenMPI 3.1+
- **CMake**: 3.18+
- **ç¼–è¯‘å™¨**: GCC 9.4+
- **Python**: 3.6+ (ç”¨äº rebuild.py)
- **yaml-cpp**: ç”¨äºé…ç½®æ–‡ä»¶è§£æ

---

## ğŸ”„ æ¢ç”µè„‘/è¿ç§»

**åªéœ€ 3 æ­¥**ï¼š

```bash
# 1. ä¿®æ”¹åº“è·¯å¾„
vim env_setup.sh  # ç¼–è¾‘ç¬¬ 10-20 è¡Œ

# 2. åŠ è½½ç¯å¢ƒ
source env_setup.sh

# 3. é‡æ–°æ„å»º
python3 rebuild.py --use-env
```

**è¯¦ç»†è¯´æ˜**: æŸ¥çœ‹ [ä½¿ç”¨è¯´æ˜_æ¢ç”µè„‘.md](ä½¿ç”¨è¯´æ˜_æ¢ç”µè„‘.md)

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### æ ¹æ®åœºæ™¯é€‰æ‹©åº“

**Poisson ç±»é—®é¢˜ï¼ˆå¯¹è§’å ä¼˜ï¼‰**:
```yaml
amgx:
  preconditioner: JACOBI  # æƒŠäººåœ°å¿«ï¼1æ¬¡è¿­ä»£
```
â†’ ä½¿ç”¨ `amgx_gpu_native_tests/amgx_gpu_native_poisson_solver`

**å¤æ‚é—®é¢˜ï¼ˆå„å‘å¼‚æ€§ã€ç—…æ€ï¼‰**:
```yaml
hypre_gpu:
  preconditioner: BOOMERAMG  # è¿­ä»£æœ€å°‘
```
â†’ ä½¿ç”¨ `hypre_gpu_tests/hypre_gpu_poisson_solver`

**ç”Ÿäº§ç¯å¢ƒï¼ˆéœ€è¦å¯é æ€§ï¼‰**:
```yaml
petsc_gpu:
  preconditioner: GAMG  # æˆç†Ÿç¨³å®š
```
â†’ ä½¿ç”¨ `petsc_gpu_tests/petsc_gpu_poisson_solver`

---

## ğŸ“Š æ€§èƒ½æ•°æ®æ–‡ä»¶

æ‰€æœ‰æµ‹è¯•ç»“æœä¿å­˜åœ¨ `results/` ç›®å½•ï¼š

```
results/
â”œâ”€â”€ amgx_results.csv / .json
â”œâ”€â”€ amgx_gpu_native_results.csv / .json  â­ æœ€å¿«
â”œâ”€â”€ hypre_results.csv / .json
â”œâ”€â”€ hypre_gpu_results.csv / .json
â”œâ”€â”€ petsc_results.csv / .json
â”œâ”€â”€ petsc_gpu_results.csv / .json
â””â”€â”€ petsc_gpu_native_results.csv / .json
```

---

## ğŸ”§ é…ç½®æ–‡ä»¶

ç¼–è¾‘ **[solver_config.yaml](solver_config.yaml)** å¯ä»¥åŠ¨æ€åˆ‡æ¢ï¼š

- ç½‘æ ¼å°ºå¯¸
- æ±‚è§£å™¨ç±»å‹
- é¢„æ¡ä»¶å™¨ç±»å‹
- é¢„æ¡ä»¶å™¨å‚æ•°

æ— éœ€é‡æ–°ç¼–è¯‘ï¼

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2025-10-14 (v2.0)

**æ–°å¢**:
- âœ… GPU Native å®ç° (AMGX, PETSc)
- âœ… YAML é…ç½®ç³»ç»Ÿ
- âœ… åŠ¨æ€é¢„æ¡ä»¶å™¨é€‰æ‹©
- âœ… è¯¦ç»†æŠ€æœ¯æ–‡æ¡£ (7ä¸ª)

**å‘ç°**:
- âš¡ AMGX + Jacobi å¯¹ Poisson é—®é¢˜ 1 æ¬¡è¿­ä»£æ”¶æ•›
- ğŸ“Š GPU Native å¯¹ AMGX æå‡ 9.2 å€
- âŒ HYPRE GPU Native åœ¨ WSL2 ç¯å¢ƒä¸‹æœ‰å…¼å®¹æ€§é—®é¢˜

**ä¼˜åŒ–**:
- ç²¾åº¦å¯¹é½ (æ‰€æœ‰åº“ ~1e-7)
- æ–‡æ¡£é‡ç»„å’Œé‡å‘½å
- åˆ é™¤å†—ä½™æ–‡æ¡£

### 2025-10-13 (v1.0)

- åˆå§‹ç‰ˆæœ¬
- 5ä¸ªæµ‹è¯•æ¨¡å—
- åŸºç¡€æ€§èƒ½å¯¹æ¯”

---

**é¡¹ç›®è·¯å¾„**: `/home/zzy/Plasma/gpu/LinearAlgebra_cuda`  
**ç»´æŠ¤çŠ¶æ€**: âœ… æ´»è·ƒ  
**æµ‹è¯•é—®é¢˜**: 2D Poisson æ–¹ç¨‹ (5ç‚¹æ¨¡æ¿)
